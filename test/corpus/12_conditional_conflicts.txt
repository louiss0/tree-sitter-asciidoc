================================================================================
Description lists should not become conditionals
================================================================================

ifdef:: This should be a paragraph because space after colon
Term:: definition

ifdefnotablock:: another paragraph

Another:: regular description item

--------------------------------------------------------------------------------

(source_file
  (description_list
    (description_item
      (description_content
        (text_with_inlines
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment))))
    (description_item
      (description_content
        (text_with_inlines
          (text_segment)))))
  (description_list
    (description_item
      (description_content
        (text_with_inlines
          (text_segment)
          (text_segment)))))
  (description_list
    (description_item
      (description_content
        (text_with_inlines
          (text_segment)
          (text_segment)
          (text_segment))))))

================================================================================
Paragraphs with directive-like words
================================================================================

This paragraph contains ifdef:: and ifndef:: words but
they are in the middle of sentences, not at start of lines.

The word endif:: can also appear here.

--------------------------------------------------------------------------------

(source_file
  (paragraph
    (text_with_inlines
      (text_segment)
      (text_segment)
      (text_segment)))
  (description_list
    (description_item
      (description_content
        (text_with_inlines
          (text_segment)
          (text_segment)
          (text_colon)
          (text_colon)
          (text_segment)
          (text_segment)))))
  (paragraph
    (text_with_inlines
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)))
  (paragraph
    (text_with_inlines
      (text_segment)
      (text_segment)))
  (description_list
    (description_item
      (description_content
        (text_with_inlines
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment))))))

================================================================================
Malformed conditionals should be paragraphs
================================================================================

ifdef::attr[extra content after bracket]
ifndef::
ifeval::[incomplete

These look like conditionals but are malformed.

--------------------------------------------------------------------------------

(source_file
  (conditional_block
    (ifdef_block
      (ifdef_open)
      (paragraph
        (text_with_inlines
          (text_segment)
          (text_colon)
          (text_colon)))
      (paragraph
        (text_with_inlines
          (text_segment)
          (text_colon)
          (text_colon)
          (text_bracket)
          (text_segment)))
      (paragraph
        (text_with_inlines
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment))))))

================================================================================
Mixing attributes and conditionals
================================================================================

:attr1: value1

ifdef::attr1[]
Content when attr1 is set
endif::[]

:attr2: value2

ifndef::missing[]
Content when missing is not set
endif::[]

--------------------------------------------------------------------------------

(source_file
  (attribute_entry
    (attribute_value))
  (conditional_block
    (ifdef_block
      (ifdef_open)
      (paragraph
        (text_with_inlines
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)))
      (endif_directive)))
  (attribute_entry
    (attribute_value))
  (conditional_block
    (ifndef_block
      (ifndef_open)
      (paragraph
        (text_with_inlines
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)))
      (endif_directive))))

================================================================================
Triple colons are not conditionals
================================================================================

something::: this is not a conditional
another:::word paragraph

--------------------------------------------------------------------------------

(source_file
  (paragraph
    (text_with_inlines
      (text_segment)
      (text_colon)
      (text_colon)
      (text_colon)
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)
      (text_segment)))
  (paragraph
    (text_with_inlines
      (text_segment)
      (text_colon)
      (text_colon)
      (text_colon)
      (text_segment)
      (text_segment))))

================================================================================
No targets in ifdef should still work
================================================================================

ifdef::[]
Content without specific target
endif::[]

ifndef::[]
Content for ifndef without target
endif::[]

--------------------------------------------------------------------------------

(source_file
  (conditional_block
    (ifdef_block
      (ifdef_open)
      (paragraph
        (text_with_inlines
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)))
      (endif_directive)))
  (conditional_block
    (ifndef_block
      (ifndef_open)
      (paragraph
        (text_with_inlines
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)
          (text_segment)))
      (endif_directive))))

================================================================================
Conditionals with attributes inside sections
================================================================================

== Main Section

:debug: true

ifdef::debug[]
Debug information here
endif::[]

=== Subsection

ifndef::production[]
Development content
endif::[]

--------------------------------------------------------------------------------

(source_file
  (section
    (section_level_2
      marker: (section_marker_2)
      title: (title)
      content: (attribute_entry
        value: (attribute_value))
      content: (conditional_block
        (ifdef_block
          directive: (ifdef_open)
          content: (paragraph
            content: (text_with_inlines
              (text_segment)
              (text_segment)
              (text_segment)))
          end: (endif_directive)))
      content: (section_level_3
        marker: (section_marker_3)
        title: (title)
        content: (conditional_block
          (ifndef_block
            directive: (ifndef_open)
            content: (paragraph
              content: (text_with_inlines
                (text_segment)
                (text_segment)))
            end: (endif_directive)))))))
